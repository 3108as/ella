{% extends "newman/ajax_content_base.html" %}
{% load admin_list %}

{% block breadcrumbs %}
    {% if not is_popup %}
        <div class="breadcrumbs">
            <div style="float: left;">
                <a href="{% url newman_admin_index %}">{% trans "Home" %}</a>
                {% if app_label %}&rsaquo; <a class="hashadr" href="/{{ app_label }}/">{% trans app_label.title %}</a>{% endif %}
                {% if title %}&rsaquo; <strong id="doc-title">{{ title }}</strong>{% endif %}
            </div>
            {% if is_user_category_filtered %}
                <div style="float: right;"><a href="{% url newman_admin_index %}">{% trans "Categories filtered by user. Click to change." %}</a></div>
            {% endif %}
        </div>
    {% endif %}
{% endblock %}

{% block content_toolbar_content %}
    <ul style="float: left;" id="filters-handler">
        <li>
            {% if is_filtered %}
                <a class="icn btn filter filter-active {% if is_popup %}popup-filter{% else %}simpleload{% endif %}" href="filters::::filters/{{ cl.get_query_string }}">{% trans 'Filters' %}<span> ({% trans 'on!' %})</span></a>
                <a class="icn eclear" href="?">{% trans 'reset' %}</a>
            {% else %}
                <a class="icn btn filter {% if is_popup %}popup-filter{% else %}simpleload{% endif %}" href="filters::::filters/{{ cl.get_query_string }}">{% trans 'Filters' %}</a>
            {% endif %}
        </li>
        <li>{% block search %}{% search_form cl %}{% endblock %}</li>
    </ul>
    {% if not is_popup %}
        <ul style="float: right; margin: 3px;">
            {% if has_add_permission %}
                <li>
                    <a href="add/" class="hashadr icn btn add">{% blocktrans with cl.opts.verbose_name as name %}Add {{ name }}{% endblocktrans %}</a>
                </li>
            {% endif %}
        </ul>
    {% endif %}
{% endblock %}

{% block content_services %}
    <div id="filters"></div>
{% endblock %}

{% if cl.formset.errors %}
    <p class="errornote">
    {% blocktrans count cl.formset.errors|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
    </p>
    <ul class="errorlist">{% for error in cl.formset.non_field_errors %}<li>{{ error }}</li>{% endfor %}</ul>
{% endif %}

{% block content %}
    <div class="hashadr-container" id="changelist">

        <form class="ajax-form dyn-addr" action="." method="post"{% if cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %}>
            {% if cl.formset %}
                {{ cl.formset.management_form }}
            {% endif %}

            {% block result_list %}
                {% if actions_on_top and cl.full_result_count and not is_popup %}{% admin_actions %}{% endif %}
                {% result_list cl %}
                {% if actions_on_bottom and cl.full_result_count %}{% admin_actions %}{% endif %}
            {% endblock %}
            {% block pagination %}{% pagination cl %}{% endblock %}
            <div class="form-metadata">
                <input type="hidden" name="success" onchange="changelist_batch_success.apply(this, arguments);" />
            </div>
        </form>

    </div>
{% endblock %}

{% block content_js %}
    {{ block.super }}

    {% if media %}
        <script type="text/javascript">
        {% for m in media %}
            request_media('{{ m }}?{{ VERSION }}');
        {% endfor %}
        </script>
    {% endif %}
{% endblock %}
